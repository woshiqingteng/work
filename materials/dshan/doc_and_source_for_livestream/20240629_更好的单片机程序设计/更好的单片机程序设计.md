# 更好的单片机程序设计

## 1. 为何使用面向对象

提问：怎么更好地点灯？

* 先写出LED的函数：

  ```c
  void led1_ctrl(int on)
  {
      if (on)
      {
          /* 打开LED1 */
      }
      else
      {
          /* 关闭LED1 */
      }        
  }
  ```

* 如果有2个LED呢？

  ```c
  void led1_ctrl(int on)
  {
      if (on)
      {
          /* 打开LED1 */
      }
      else
      {
          /* 关闭LED1 */
      }        
  }
  
  void led2_ctrl(int on)
  {
      if (on)
      {
          /* 打开LED2 */
      }
      else
      {
          /* 关闭LED2 */
      }        
  }
  ```

* 怎么使用？各个LED的名字都不同，有100个LED时你要调用100个不同的函数！

* 如果有100个LED呢？写100个函数吗？对于同一个主控，它们的操作时类似的

  ```c
void led_ctrl(int led_no, int on)
  {
      if (on)
      {
          /* 打开编号为led_no的LED 
           * 比如可以根据编号设置寄存器里不同的位
           */        
      }
      else
      {
          /* 关闭编号为led_no的LED 
           * 比如可以根据编号设置寄存器里不同的位
           */
      }        
  }
  ```
  
* 如果这些LED的操作不一样呢？

  ```c
  void led_ctrl(int led_no, int on)
  {
      if (on)
      {
          /* 根据不同的编号执行不同的操作 */
  		if (led_no < = 100)
          {
              /* 操作GPIO */
          }
          else if(led_no <= 200)
          {
              /* 操作I2C */
          }
          else
          {
          	/* 操作SPI */
          }
      }
      else
      {
          /* 根据不同的编号执行不同的操作 */
  		if (led_no < = 100)
          {
              /* 操作GPIO */
          }
          else if(led_no <= 200)
          {
              /* 操作I2C */
          }
          else
          {
          	/* 操作SPI */
          }
      }    
  }
  ```

* 如果有100个LED呢？100个Switch？怎么改进？面向对象！

* 其他好处：驱动分别开发



## 2. 如何分层设计一个小系统



## 3. 如何把一个程序拆分为多个系统



  

  

  





